<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-pages/concepts/version_conflicts">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">Version conflicts | Lockfile Explorer</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://lfx.rushstack.io/images/site/lfx-ograph.jpg"><meta data-rh="true" name="twitter:image" content="https://lfx.rushstack.io/images/site/lfx-ograph.jpg"><meta data-rh="true" property="og:url" content="https://lfx.rushstack.io/pages/concepts/version_conflicts/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Version conflicts | Lockfile Explorer"><meta data-rh="true" name="description" content="From a high level perspective, Lockfile Explorer is a tool for coordinating versions of library packages."><meta data-rh="true" property="og:description" content="From a high level perspective, Lockfile Explorer is a tool for coordinating versions of library packages."><link data-rh="true" rel="icon" href="/images/site/favicon.ico"><link data-rh="true" rel="canonical" href="https://lfx.rushstack.io/pages/concepts/version_conflicts/"><link data-rh="true" rel="alternate" href="https://lfx.rushstack.io/pages/concepts/version_conflicts/" hreflang="en"><link data-rh="true" rel="alternate" href="https://lfx.rushstack.io/pages/concepts/version_conflicts/" hreflang="x-default"><link rel="search" type="application/opensearchdescription+xml" title="Lockfile Explorer" href="/opensearch.xml">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic,700italic"><link rel="stylesheet" href="/assets/css/styles.759d4da6.css">
<link rel="preload" href="/assets/js/runtime~main.47525cdf.js" as="script">
<link rel="preload" href="/assets/js/main.2c6dfc92.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div class="suiteNavBar_rHPh"><div role="button" class="waffle_FRnN waffleInteraction_uHqh"><img src="/images/suitenav/rs-waffle.svg"></div><div class="waffleDivider_XicE"></div><a href="https://rushstack.io/" class="suiteNavItem_tL2w">Rush Stack</a><a href="https://rushstack.io/pages/shop/" class="suiteNavItem_tL2w">Shop</a><a href="https://rushstack.io/blog/" class="suiteNavItem_tL2w">Blog</a><a href="https://rushstack.io/community/events/" class="suiteNavItem_tL2w">Events</a></div><div role="region" aria-label="Skip to main content"><a class="skipToContent_sQ89" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/images/site/lockfile-explorer.svg" alt="Lockfile Explorer" class="themedImage_SmPy themedImage--light_jc2g"><img src="/images/site/lockfile-explorer.svg" alt="Lockfile Explorer" class="themedImage_SmPy themedImage--dark_D6nB"></div><b class="navbar__title text--truncate"></b></a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_eEuM"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/pages/concepts/version_conflicts/" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/pages/basics/getting_started/">Docs</a><a class="navbar__item navbar__link" href="/pages/support/news/">News</a><a class="navbar__item navbar__link" href="/pages/support/contributing/">GitHub</a><a class="navbar__item navbar__link" href="/pages/support/help/">Help</a><div class="searchBox_wgNs"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_A0IM docsWrapper_kGXj"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_lVE9" type="button"></button><div class="docPage_ulef"><aside class="theme-doc-sidebar-container docSidebarContainer_APyL"><div class="sidebarViewport_Ic2x"><div class="sidebar_IuMp"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_lHqR"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Introduction</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/basics/getting_started/">Getting started</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active">Versioning Concepts</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/pages/concepts/version_conflicts/">Version conflicts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/concepts/semver/">SemVer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/concepts/install_models/">Installation models</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/concepts/tracing_resolution/">Tracing package resolution</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/concepts/pnpm_lockfile/">The PNPM lockfile</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/concepts/strict_settings/">Strict settings</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Scenarios</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/scenarios/demos_repo/">Demos repository</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/scenarios/side-by-side_versions/">Side-by-side versions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/scenarios/peer_dependencies/">Peer dependencies</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/scenarios/npm_doppelgangers/">NPM doppelgangers</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Support</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/support/help/">Help</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/support/news/">What&#x27;s new</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/support/contributing/">Contributing</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_BzXK"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_wG_o"><div class="docItemContainer_jqGH"><article><div class="tocCollapsible_Vels theme-doc-toc-mobile tocMobile_PauL"><button type="button" class="clean-btn tocCollapsibleButton_PIvq">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Version conflicts</h1></header><p>From a high level perspective, Lockfile Explorer is a tool for coordinating versions of library packages.
This is a classic problem in computer science, sometimes jokingly called <strong>dependency hell</strong> or <strong>DLL hell</strong>.</p><h2 class="anchor anchorWithStickyNavbar_abXo" id="an-example-problem">An example problem<a href="#an-example-problem" class="hash-link" aria-label="Direct link to An example problem" title="Direct link to An example problem">​</a></h2><blockquote><p><strong>Some notation</strong></p><p>We&#x27;ll use an expression like <code>calendar@1.0.0</code> to indicate the published version <code>1.0.0</code> of the
NPM package <code>calendar</code>. NPM package names sometimes also include a scope, for example <code>@my-company/calendar</code>,
in which case we would write <code>@my-company/calendar@1.0.0</code>.</p><p>As a shorthand, where the package name doesn&#x27;t matter, we may replace the package name with a
capital letter variable such as <code>A@1.2.3</code> or <code>B@3.2.1</code>. If the extra SemVer parts are unimportant,
we may write <code>A@1</code> as a shorthand for <code>A@1.0.0</code>. These shorthand notations are not legal NPM package
names or versions.</p></blockquote><p>As a motivating example, suppose we&#x27;re developing a project <code>my-app</code> that depends on two hypothetical
library packages <code>calendar@1.0.0</code> and <code>video-player@2.0.0</code>. Let&#x27;s suppose that these two libraries
both depend on <code>fancy-button</code>, but different versions:</p><ul><li><code>calendar@1.0.0</code> depends on <code>fancy-button@3.0.0</code></li><li><code>video-player@2.0.0</code> depends on <code>fancy-button@4.0.0</code></li></ul><p>Why are the versions inconsistent? Perhaps the latest release of <code>calendar</code> was published sometime ago,
whereas <code>video-player</code> just got a new release, so it&#x27;s using the new version 4 of <code>fancy-button</code>.
This creates a <strong>&quot;diamond dependency&quot;</strong>, where <code>my-app</code> directly depends on <code>calendar</code> and <code>video-player</code>
but indirectly depends on <code>fancy-button</code>. And in this case, the diamond dependency causes <strong>side-by-side
versions</strong> of <code>fancy-button</code>. Specifically the versions <code>3.0.0</code> and <code>4.0.0</code>.</p><p>Side-by-side versions may cause performance issues, such as bloating the size of your bundled app.
They may cause compile failures, for example if the TypeScript types for <code>fancy-button</code> conflict
with each other. They may also cause runtime failures, for example initializing multiple instances
of an object that is supposed to be a singleton.</p><h2 class="anchor anchorWithStickyNavbar_abXo" id="possible-solutions">Possible solutions<a href="#possible-solutions" class="hash-link" aria-label="Direct link to Possible solutions" title="Direct link to Possible solutions">​</a></h2><p>How can we eliminate these side-by-side versions? Here&#x27;s some possible ideas:</p><ol><li><p>Ideally, we should upgrade <code>calendar</code> to a newer version that uses <code>fancy-button@4.0.0</code>.
In our example, <code>1.0.0</code> was the latest release, so this means we need to contact the maintainers
and get them to publish a new release. This can often take days or even months.</p></li><li><p>Force <code>calendar</code> to use <code>fancy-button@4.0.0</code>. The PNPM package manager provides mechanisms such
as <code>.pnpmfile.cjs</code> that can override the <strong>package.json</strong> file for <code>calendar</code> to force it to use
a different version. This can be a handy shortcut, but it is risky: <code>calendar</code> wasn&#x27;t tested with
<code>fancy-button@4.0.0</code>. If Version 4 includes a breaking change, for example renaming an API,
then the code will malfunction.</p></li><li><p>Downgrade <code>video-player</code> to an older version that uses <code>fancy-button@3.0.0</code>. This is a less
happy solution, since an older release of <code>video-player</code> may be missing features that we need.
We may have to go very far back in time to find a compatible version, or it may be the case
that there is no such version -- the first release of <code>video-player</code> was already using <code>fancy-button</code>
version 4.</p></li></ol><p>It&#x27;s not always obvious which approach is best. It can require some trial and error.
Our example here involved only four packages (<code>my-app</code>, <code>calendar</code>, <code>video-player</code>, and <code>fancy-button</code>),
whereas a typical monorepo has thousands of package dependencies. And side-by-side versions are just one
of many possible version conflicts that can arise among libraries. It does feel like dependency &quot;hell.&quot;</p><p>However, take heart! With some practice, and some guiding principles, and help from Lockfile Explorer,
you can learn how to solve these problems.</p><h2 class="anchor anchorWithStickyNavbar_abXo" id="is-there-a-shortcut">Is there a shortcut?<a href="#is-there-a-shortcut" class="hash-link" aria-label="Direct link to Is there a shortcut?" title="Direct link to Is there a shortcut?">​</a></h2><p>Version conflicts arise from a lack of <strong>coherence</strong> in authoring of source code: In our example,
the maintainers of <code>calendar</code>, <code>video-player</code>, and <code>fancy-button</code> work in different Git repositories.
They publish at different times. They probably don&#x27;t even communicate with each other. When
<code>fancy-button</code> releases <code>4.0.0</code>, we can&#x27;t upgrade <code>my-app</code> until each intermediary dependency has
upgraded and published a new version. This time lag can be considerable, especially if Version 4
has breaking API changes that require nontrivial work to fix. Lack of coherence creates time lags,
which cause this trouble.</p><p><strong>Shortcut 1: Full coherence</strong> The fully coherent way of working is the <strong>monorepo</strong>:
All your source code goes in a single branch of a single repo. If a breaking change is made to the
API for <code>fancy-button</code>, all consumers must be fixed at the time when that change is merged.
The cost of fixing downstream consumers is paid by the person who introduced the break
(&quot;you broke it, you fix it&quot;), which avoids creating downstream victims, and ensures costs and effects
are fully analyzed before a prospective change is released. Monorepos work great for a large code base
that&#x27;s maintained by partner teams within a single organization, but of course it&#x27;s not a realistic model
for external libraries maintained by different parties on the internet. Nonetheless, if you think about it,
the various mitigations that we&#x27;ll be presenting are basically approximating a monorepo, by manipulating
your <code>node_modules</code> dependencies as if they were part of your own set of projects.</p><p><strong>Shortcut 2: Complete decoupling:</strong> The other escape hatch is to develop fully self-contained libraries,
whose <strong>package.json</strong> files have no dependencies at all. (In fact, this model was enforced by the
Bower package manager that predated NPM.) Unfortunately a complete lack of code sharing brings its
own problems, of duplicated code and reinvented wheels.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/microsoft/rushstack-websites/tree/main/websites/lfx.rushstack.io/docs/pages/concepts/version_conflicts.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_DX5v" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_hn6L"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/pages/basics/getting_started/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Getting started</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/pages/concepts/semver/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">SemVer</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_JkeW thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#an-example-problem" class="table-of-contents__link toc-highlight">An example problem</a></li><li><a href="#possible-solutions" class="table-of-contents__link toc-highlight">Possible solutions</a></li><li><a href="#is-there-a-shortcut" class="table-of-contents__link toc-highlight">Is there a shortcut?</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">© 2023 Microsoft</div></div></div></footer></div>
<script src="/assets/js/runtime~main.47525cdf.js"></script>
<script src="/assets/js/main.2c6dfc92.js"></script>
</body>
</html>