<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-pages/concepts/strict_settings">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.1">
<link rel="search" type="application/opensearchdescription+xml" title="Lockfile Explorer" href="/opensearch.xml">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic,700italic"><title data-rh="true">Strict settings | Lockfile Explorer</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://lfx.rushstack.io/images/site/lfx-ograph.jpg"><meta data-rh="true" name="twitter:image" content="https://lfx.rushstack.io/images/site/lfx-ograph.jpg"><meta data-rh="true" property="og:url" content="https://lfx.rushstack.io/pages/concepts/strict_settings/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Strict settings | Lockfile Explorer"><meta data-rh="true" name="description" content="Many lockfile problems can be avoided by enabling various &quot;strict&quot; settings for"><meta data-rh="true" property="og:description" content="Many lockfile problems can be avoided by enabling various &quot;strict&quot; settings for"><link data-rh="true" rel="icon" href="/images/site/favicon.ico"><link data-rh="true" rel="canonical" href="https://lfx.rushstack.io/pages/concepts/strict_settings/"><link data-rh="true" rel="alternate" href="https://lfx.rushstack.io/pages/concepts/strict_settings/" hreflang="en"><link data-rh="true" rel="alternate" href="https://lfx.rushstack.io/pages/concepts/strict_settings/" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.34967ffb.css">
<link rel="preload" href="/assets/js/runtime~main.5e90992f.js" as="script">
<link rel="preload" href="/assets/js/main.e7d177b0.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div class="suiteNavBar_rHPh"><div role="button" class="hamburger_AuD3 hamburgerInteraction_B9ML"><img src="/images/suitenav/rs-hamburger.svg"></div><div class="hamburgerDivider_zNDB"></div><a href="https://rushstack.io/pages/overview/roadmap/" class="suiteNavItem_tL2w">Roadmap</a><a href="https://rushstack.io/pages/shop/" class="suiteNavItem_tL2w">Shop</a><a href="https://rushstack.io/community/events/" class="suiteNavItem_tL2w">Events</a></div><div role="region"><a href="#" class="skipToContent_yHtx">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/images/site/lockfile-explorer.svg" alt="Lockfile Explorer" class="themedImage_xqNz themedImage--light_NH9z"><img src="/images/site/lockfile-explorer.svg" alt="Lockfile Explorer" class="themedImage_xqNz themedImage--dark_aoV8"></div><b class="navbar__title text--truncate"></b></a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_Do5L"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/pages/concepts/strict_settings/" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">English</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/pages/basics/getting_started/">Docs</a><a class="navbar__item navbar__link" href="/pages/support/news/">News</a><a class="navbar__item navbar__link" href="/pages/support/contributing/">GitHub</a><a class="navbar__item navbar__link" href="/pages/support/help/">Help</a><div class="searchBox_Royc"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_jj2R docsWrapper__pZK"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_iDCD" type="button"></button><div class="docPage_mREL"><aside class="theme-doc-sidebar-container docSidebarContainer_RfV8"><div class="sidebar_khl0"><nav class="menu thin-scrollbar menu_usJe"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Introduction</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/basics/getting_started/">Getting started</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active">Versioning Concepts</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/concepts/version_conflicts/">Version conflicts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/concepts/semver/">SemVer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/concepts/install_models/">Installation models</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/concepts/tracing_resolution/">Tracing package resolution</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/concepts/pnpm_lockfile/">The PNPM lockfile</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/pages/concepts/strict_settings/">Strict settings</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Scenarios</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/scenarios/demos_repo/">Demos repository</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/scenarios/side-by-side_versions/">Side-by-side versions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/scenarios/peer_dependencies/">Peer dependencies</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/scenarios/npm_doppelgangers/">NPM doppelgangers</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Support</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/support/help/">Help</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/support/news/">What&#x27;s new</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pages/support/contributing/">Contributing</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_Spkt"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_B0FM"><div class="docItemContainer_urdu"><article><div class="tocCollapsible_fai6 theme-doc-toc-mobile tocMobile_AbM5"><button type="button" class="clean-btn tocCollapsibleButton_Vjdw">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Strict settings</h1></header><p>Many lockfile problems can be avoided by enabling various &quot;strict&quot; settings for
Rush and PNPM. These settings activate additional validation checks and disable
some &quot;magic&quot; features that try to hide problems caused by an incorrect lockfile.</p><p>These strict settings are disabled by default, because it can take some effort
to get them enabled in a preexisting mononrepo. Once enabled, engineers may encounter
versioning errors more frequently in their day to day work, but these errors are generally
less costly to manage than the much deeper problems that can arise in a monorepo
with inherent version conflicts, whose engineers learned about versioning by studying
an environment that is fundamentally broken.</p><h2 class="anchor anchorWithStickyNavbar_SLHE" id="strictpeerdependencies">strictPeerDependencies<a class="hash-link" href="#strictpeerdependencies" title="Direct link to heading">​</a></h2><p><strong>Difficulty Level: Easy</strong></p><p>It can take some work to get <code>strictPeerDependencies</code> initially enabled in a legacy monorepo;
however, once your lockfile is in a clean state, it&#x27;s relatively easy to fix any future errors
that arise.</p><p><a href="https://rushjs.io/pages/configs/pnpm-config_json/" target="_blank" rel="noopener noreferrer">common/config/rush/pnpm-config.json</a></p><div class="language-js codeBlockContainer_rOsD theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_RK14"><pre tabindex="0" class="prism-code language-js codeBlock_O81Q thin-scrollbar"><code class="codeBlockLines_oxQH"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">   * If true, then Rush will add the `--strict-peer-dependencies` command-line parameter when</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">   * invoking PNPM.  This causes `rush update` to fail if there are unsatisfied peer dependencies,</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">   * which is an invalid state that can cause build failures or incompatible dependency versions.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">   * (For historical reasons, JavaScript package managers generally do not treat this invalid</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">   * state as an error.)</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">   *</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">   * PNPM documentation: https://pnpm.io/npmrc#strict-peer-dependencies</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">   *</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">   * The default value is false to avoid legacy compatibility issues.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">   * It is strongly recommended to set `strictPeerDependencies=true`.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">   */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string-property property" style="color:#36acaa">&quot;strictPeerDependencies&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><br></span></code></pre><div class="buttonGroup_U8U_"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_ZlfJ" aria-hidden="true"><svg class="copyButtonIcon_Yhmw" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_vhcl" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_SLHE" id="ensureconsistentversions">ensureConsistentVersions<a class="hash-link" href="#ensureconsistentversions" title="Direct link to heading">​</a></h2><p><strong>Difficulty Level: Medium</strong></p><p>It can take some work to get <code>ensureConsistentVersions</code> enabled in a legacy monorepo, however once
your versions are consistent, it&#x27;s relatively easy to fix any future errors that arise. For any difficult
cases, you can simply exempt the affected package using <code>allowedAlternativeVersions</code>.</p><p><a href="https://rushjs.io/pages/configs/rush_json/" target="_blank" rel="noopener noreferrer">rush.json</a></p><div class="language-js codeBlockContainer_rOsD theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_RK14"><pre tabindex="0" class="prism-code language-js codeBlock_O81Q thin-scrollbar"><code class="codeBlockLines_oxQH"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * If you would like the version specifiers for your dependencies to be consistent, then</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * uncomment this line. This is effectively similar to running &quot;rush check&quot; before any</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * of the following commands:</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> *   rush install, rush update, rush link, rush version, rush publish</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * In some cases you may want this turned on, but need to allow certain packages to use a different</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * version. In those cases, you will need to add an entry to the &quot;allowedAlternativeVersions&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * section of the common-versions.json.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// &quot;ensureConsistentVersions&quot;: true,</span><br></span></code></pre><div class="buttonGroup_U8U_"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_ZlfJ" aria-hidden="true"><svg class="copyButtonIcon_Yhmw" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_vhcl" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_SLHE" id="disable-pnpm-hoisting">Disable PNPM hoisting<a class="hash-link" href="#disable-pnpm-hoisting" title="Direct link to heading">​</a></h2><p><strong>Difficulty level: Advanced</strong></p><p>This setting is somewhat challenging in a large monorepo, because many hoisted dependencies
may require fixups. We were able to successfully enable this setting in the
<a href="https://github.com/microsoft/rushstack/" target="_blank" rel="noopener noreferrer">microsoft/rushstack</a>
monorepo where Lockfile Explorer is developed. For some thoughts about a more gradual
migration path, see
<a href="https://github.com/microsoft/rushstack/issues/3635" target="_blank" rel="noopener noreferrer">Design Proposal #3635</a>.</p><p><a href="https://rushjs.io/pages/configs/npmrc/" target="_blank" rel="noopener noreferrer">common/config/rush/.npmrc</a></p><div class="language-bash codeBlockContainer_rOsD theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_RK14"><pre tabindex="0" class="prism-code language-bash codeBlock_O81Q thin-scrollbar"><code class="codeBlockLines_oxQH"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Disable hoisted phantom dependencies in this repository.  PNPM has two separate</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># settings for hoisting, but they have equivalent effects because Rush monorepo</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># relocates the workspace root to the &quot;common/temp&quot; path.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 1. Don&#x27;t hoist under common/temp/node_modules/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public-hoist-pattern</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 2. Don&#x27;t hoist under common/temp/node_modules/.pnpm/node_modules/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">hoist</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hoist-pattern</span><span class="token operator" style="color:#393A34">=</span><br></span></code></pre><div class="buttonGroup_U8U_"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_ZlfJ" aria-hidden="true"><svg class="copyButtonIcon_Yhmw" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_vhcl" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>NOTE: In the future, we plan to replace these <code>.npmrc</code> settings
with an official Rush setting with JSON schema validation and
a more intuitive interface. See
<a href="https://github.com/microsoft/rushstack/issues/3542" target="_blank" rel="noopener noreferrer">GitHub Issue #3542</a>
for discussion.</p></blockquote><h2 class="anchor anchorWithStickyNavbar_SLHE" id="preventmanualshrinkwrapchanges">preventManualShrinkwrapChanges<a class="hash-link" href="#preventmanualshrinkwrapchanges" title="Direct link to heading">​</a></h2><p><strong>Difficulty Level: Easy</strong></p><p>To reduce the likelihood of merge conflicts, we recommend waiting to enable this setting
until you start encountering problems caused by people manually tampering with the lockfile.</p><p><a href="https://rushjs.io/pages/configs/pnpm-config_json/" target="_blank" rel="noopener noreferrer">common/config/rush/pnpm-config.json</a></p><div class="language-js codeBlockContainer_rOsD theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_RK14"><pre tabindex="0" class="prism-code language-js codeBlock_O81Q thin-scrollbar"><code class="codeBlockLines_oxQH"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">   * If true, then `rush install` will report an error if manual modifications</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">   * were made to the PNPM shrinkwrap file without running `rush update` afterwards.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">   *</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">   * This feature protects against accidental inconsistencies that may be introduced</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">   * if the PNPM shrinkwrap file (`pnpm-lock.yaml`) is manually edited.  When this</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">   * feature is enabled, `rush update` will append a hash to the file as a YAML comment,</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">   * and then `rush update` and `rush install` will validate the hash.  Note that this</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">   * does not prohibit manual modifications, but merely requires `rush update` be run</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">   * afterwards, ensuring that PNPM can report or repair any potential inconsistencies.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">   *</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">   * To temporarily disable this validation when invoking `rush install`, use the</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">   * `--bypass-policy` command-line parameter.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">   *</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">   * The default value is false.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">   */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string-property property" style="color:#36acaa">&quot;preventManualShrinkwrapChanges&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><br></span></code></pre><div class="buttonGroup_U8U_"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_ZlfJ" aria-hidden="true"><svg class="copyButtonIcon_Yhmw" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_vhcl" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_SLHE" id="settings-hardwired-by-rush">Settings hardwired by Rush<a class="hash-link" href="#settings-hardwired-by-rush" title="Direct link to heading">​</a></h2><p>If you&#x27;re using the Rush build orchestrator, these settings are always automatically enabled:</p><ul><li><a href="https://pnpm.io/npmrc#link-workspace-packages" target="_blank" rel="noopener noreferrer">--link-workspace-packages=false</a></li><li><a href="https://pnpm.io/npmrc#prefer-frozen-lockfile" target="_blank" rel="noopener noreferrer">--prefer-frozen-lockfile=false</a></li><li><a href="https://pnpm.io/npmrc#ignore-compatibility-db" target="_blank" rel="noopener noreferrer">ignoreCompatibilityDb=true</a></li></ul><h2 class="anchor anchorWithStickyNavbar_SLHE" id="settings-to-avoid">Settings to avoid<a class="hash-link" href="#settings-to-avoid" title="Direct link to heading">​</a></h2><p>It&#x27;s strongly recommended NOT to enable these settings:</p><ul><li><a href="https://pnpm.io/npmrc#shamefully-hoist" target="_blank" rel="noopener noreferrer">shamefully-hoist=true</a></li><li><a href="https://pnpm.io/npmrc#auto-install-peers" target="_blank" rel="noopener noreferrer">auto-install-peers=true</a></li><li><a href="https://pnpm.io/npmrc#shared-workspace-lockfile" target="_blank" rel="noopener noreferrer">shared-workspace-lockfile=false</a></li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/microsoft/rushstack-websites/tree/main/websites/lfx.rushstack.io/docs/pages/concepts/strict_settings.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_BLyC" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_w8CT"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/pages/concepts/pnpm_lockfile/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">The PNPM lockfile</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/pages/scenarios/demos_repo/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Demos repository</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_PJGn thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#strictpeerdependencies" class="table-of-contents__link toc-highlight">strictPeerDependencies</a></li><li><a href="#ensureconsistentversions" class="table-of-contents__link toc-highlight">ensureConsistentVersions</a></li><li><a href="#disable-pnpm-hoisting" class="table-of-contents__link toc-highlight">Disable PNPM hoisting</a></li><li><a href="#preventmanualshrinkwrapchanges" class="table-of-contents__link toc-highlight">preventManualShrinkwrapChanges</a></li><li><a href="#settings-hardwired-by-rush" class="table-of-contents__link toc-highlight">Settings hardwired by Rush</a></li><li><a href="#settings-to-avoid" class="table-of-contents__link toc-highlight">Settings to avoid</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">© 2022 Microsoft</div></div></div></footer></div>
<script src="/assets/js/runtime~main.5e90992f.js"></script>
<script src="/assets/js/main.e7d177b0.js"></script>
</body>
</html>